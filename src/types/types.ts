// src/types.ts
export type DataCategory = "simple" | "behavioral" | "financial" | "sensitive";

export const CATEGORY_HINTS: Record<DataCategory, string[]> = {
  simple: [
    "1 คะแนน (พื้นฐาน): เมื่อเกิดเหตุการละเมิดที่เกี่ยวข้องกับข้อมูลทั่วไป (Simple data) และผู้ควบคุมข้อมูลส่วนบุคคลไม่ทราบถึงปัจจัยรุนแรง (Aggravating factor) อื่นๆ",
    "2 คะแนน: เมื่อปริมาณของข้อมูลทั่วไปนั้นมาก และ/หรือ ลักษณะของผู้ควบคุมข้อมูลส่วนบุคคล อาจทำให้สามารถประเมินบุคคลในด้านสถานะทางสังคม หรือสถานะทางการเงินได้",
    "3 คะแนน: เมื่อปริมาณของข้อมูลทั่วไปและ/หรือ ลักษณะของผู้ควบคุมข้อมูลส่วนบุคคล ทำให้ทราบถึงสถานะทางสุขภาพ ความชื่นชอบทางเพศ แนวคิดทางการเมือง ความเชื่อทางศาสนา",
    "4 คะแนน: เมื่อคำนึงถึงลักษณะเฉพาะของบุคคล (เช่นบุคคลเปราะบาง ผู้เยาว์) ข้อมูลนั้นเป็นอันตรายต่อความปลอดภัยส่วนตัว หรือสภาพจิตใจหรือทางร่างกาย",
  ],
  behavioral: [
    "2 คะแนน (พื้นฐาน): เมื่อละเมิดเกี่ยวข้องกับข้อมูลพฤติกรรม และผู้ควบคุมข้อมูลส่วนบุคคลไม่ทราบถึงปัจจัยที่ทำให้ร้ายแรงขึ้น (Aggravating factor) หรือน้อยลง (Lessening Factor)",
    "1 คะแนน: เมื่อข้อมูลพื้นฐานไม่ได้บ่งบอกถึงพฤติกรรมของบุคคลนั้น หรือเป็นข้อมูลที่เก็บรวบรวมได้โดยง่ายจากแหล่งข้อมูลสาธารณะที่ไม่ได้มาจากเหตุการละเมิด (เช่น การรวมข้อมูลการค้นหาเว็บไซต์)",
    "3 คะแนน: เมื่อปริมาณของข้อมูลพฤติกรรม และ/หรือ ลักษณะของผู้ควบคุมข้อมูลส่วนบุคคลสามารถสร้าง หรือเปิดเผย ข้อมูลรายละเอียดเกี่ยวกับการใช้ชีวิตประจำวัน หรือนิสัยส่วนตัวได้",
    "4 คะแนน: ถ้าสามารถสร้างข้อมูลอ่อนไหวของบุคคลได้",
  ],
  financial: [
    "3 คะแนน (พื้นฐาน): เมื่อละเมิดเกี่ยวข้องกับข้อมูลทางการเงิน และผู้ควบคุมข้อมูลส่วนบุคคลไม่ทราบถึงปัจจัยที่ทำให้ร้ายแรงขึ้น (Aggravating factor) หรือน้อยลง (Lessening Factor)",
    "1 คะแนน: เมื่อข้อมูลพื้นฐานไม่ได้บ่งบอกข้อมูลทางการเงินของบุคคลได้ (เช่น ข้อเท็จจริงที่บุคคลเป็นลูกค้าธนาคารแห่งหนึ่ง โดยไม่มีข้อมูลทางการเงินอื่นๆ)",
    "2 คะแนน: เมื่อข้อมูลนั้นมีข้อมูลทางการเงิน แต่ไม่ได้บ่งบอกถึงสถานะทางการเงิน/เหตุการณ์ทางการเงินของบุคคล (เช่น ปรากฎเลขบัญชีธนาคารโดยไม่ได้มีข้อมูลทางการเงินประกอบเพิ่มเติม)",
    "4 คะแนน: เมื่อโดยสภาพ และ/หรือ ปริมาณของข้อมูล ข้อมูลทางการเงินแบบเต็ม (เช่น ข้อมูลบัตรเครดิต เป็นต้น) ถูกเปิดเผยออกไปซึ่งสามารถทำให้เกิดการฉ้อโกง (Fraud) หรือสร้างข้อมูลโปรไฟล์ทางสถานะทางสังคมหรือทางการเงินได้",
  ],
  sensitive: [
    "4 คะแนน (พื้นฐาน): เมื่อละเมิดเกี่ยวข้องกับข้อมูลส่วนบุคคลอ่อนไหว และผู้ควบคุมข้อมูลส่วนบุคคลไม่ทราบถึงปัจจัยที่ทำให้น้อยลง (Lessening Factor)",
    "1 คะแนน: เมื่อข้อมูลพื้นฐานไม่ได้บ่งบอกถึงพฤติกรรมของบุคคลนั้น หรือเป็นข้อมูลที่เก็บรวบรวมได้โดยง่ายจากแหล่งข้อมูลสาธารณะที่ไม่ได้มาจากเหตุการละเมิด (เช่น การรวมข้อมูลการค้นหาเว็บไซต์)",
    "2 คะแนน: เมื่อสภาพของข้อมูลสามารถนำไปสู่สมมุติฐานทั่วไป",
    "3 คะแนน: เมื่อสภาพของข้อมูลสามารถนำไปสู่สมมุติฐานที่เกี่ยวข้องกับข้อมูลอ่อนไหวได้",
  ],
};

  // Canonical EI keys
export const ALL_EI_KEYS = [
  "fullName",
  "idCard",
  "phoneAddress",
  "email",
  "image",
  "alias",
] as const;

export type EICategoryKey = typeof ALL_EI_KEYS[number];

export const EICATEGORY_HINTS: Record<EICategoryKey, string[]> = {
  fullName: [
    "0.25 คะแนน: ระดับที่ไม่สามารถระบุตัวตนได้แน่ชัด (Negligible) : จำนวนประชากรของประเทศใช้ชื่อนามสกุลเดียวกันจำนวนมาก",
    "0.5 คะแนน: ระดับที่ระบุตัวตนได้จำกัด (Limited) : จำนวนประชากรของประเทศใช้ชื่อนามสกุลเดียวกันจำนวนน้อย",
    "0.75 คะแนน: ระดับที่ระบุตัวตนได้อย่างมีนัยสำคัญ (Significant): จำนวนประชากรของจังหวัดเล็กๆที่ซึ่งใช้ชื่อนามสกุลเดียวกันน้อยหรือแทบไม่มี",
    "1 คะแนน: ระดับที่ระบุตัวตนได้อย่างแน่ชัด (Maximum) : จำนวนประชากรของประเทศใช้ข้อมูลวันเกิดและ Email",
  ],
  idCard: [
    "0.25 คะแนน: ระดับที่ไม่สามารถระบุตัวตนได้แน่ชัด (Negligible) : เมื่อไม่สามารถหาข้อมูลอื่นใดของบุคคลได้หรือเป็นไปไม่ได้ที่จะหาข้อมูลอื่นใดของบุคคลได้อีกเว้นแต่ได้เข้าถึงถังข้อมูลนั้น",
    "0.75 คะแนน: ระดับที่ระบุตัวตนได้อย่างมีนัยสำคัญ (Significant): การละเมิดทำให้เปิดเผยข้อมูลการระบุตัวตนของบุคคลอื่น ๆ เพิ่มเติมได้อีก (เช่น เลขที่ประกันสังคมเปิดเผยข้อมูลวันเกิด) และสามารถเชื่อมโยงไปยังข้อมูลอื่น ๆ (เช่น เลขไปรษณีย์หรือ Email)",
    "1 คะแนน: ระดับที่ระบุตัวตนได้อย่างแน่ชัด (Maximum) : เมื่อมีการเปิดเผยจากถังข้อมูล (ข้อมูลบัตรประจำตัวประชาชน หละชื่อนามสกุล หรือรูปภาพ)",
  ],
  phoneAddress: [
    "0.25 คะแนน: ระดับที่ไม่สามารถระบุตัวตนได้แน่ชัด (Negligible) : เมื่อพิจารณาจากประชากรของประเทศ เบอร์/ที่อยู่ ไม่ได้ขึ้นทะเบียนในระบบที่เปิดเผยสาธารณะ",
    "0.5 คะแนน: ระดับที่ระบุตัวตนได้จำกัด (Limited) : เมื่อพิจารณาจากประชากรของจังหวัด เบอร์/ที่อยู่ ไม่ได้ขึ้นทะเบียนในระบบที่เปิดเผยสาธารณะ (แต่ระบุได้จากการติดต่อสื่อสารกับบุคคลนั้นๆ)",
    "1 คะแนน: ระดับที่ระบุตัวตนได้อย่างแน่ชัด (Maximum) : เมื่อพิจารณาจากประชากรของประเทศ เบอร์/ที่อยู่ ขึ้นทะเบียนในระบบที่เปิดเผยสู่สาธารณะ",
  ],
  email: [
    "0.25 คะแนน: ระดับที่ไม่สามารถระบุตัวตนได้แน่ชัด (Negligible) : เมื่อ Email ไม่ได้เปิดเผยข้อมูลส่วนบุคคลอื่นใด (เช่น ชื่อ) และไม่ได้ใช้เป็นช่องทางติดต่อหลักในอินเตอร์เน็ต หรือโซเชียลเน็ทเวิร์ค",
    "0.75 คะแนน: ระดับที่ระบุตัวตนได้อย่างมีนัยสำคัญ (Significant): เมื่อ Email ไม่ได้เปิดเผยข้อมูลส่วนบุคคลอื่นใด (เช่น ชื่อ) แต่ใช้เป็นช่องทางติดต่อหลักในอินเตอร์เน็ต หรือโซเชียลเน็ทเวิร์ค (ค้นหาได้จากเว็บไซต์)",
    "1 คะแนน: ระดับที่ระบุตัวตนได้อย่างแน่ชัด (Maximum) : เมื่อข้อมูลส่วนบุคคลเปิดเผยชื่อของบุคคล และใช้เป็นช่องทางหลักในอินเทอร์เน็ต หรือโซเชียลเน็ทเวิร์ค (ค้นหาได้จากเว็บไซต์)",
  ],
  image: [
    "0.25 คะแนน: ระดับที่ไม่สามารถระบุตัวตนได้แน่ชัด (Negligible) : รูปภาพนั้นคลุมเครือไม่ชัด (เช่น รูปภาพวิดิโอจาก CCTV โดยถ่ายในระยะไกล)",
    "0.5 คะแนน: ระดับที่ระบุตัวตนได้จำกัด (Limited) : รูปภาพนั้นคลุมเครือไม่ชัด แต่มีข้อมูลเพิ่มเติมที่สามารถระบุตัวตนของบุคคลได้ (เช่น เป็นสถานที่เฉพาะ)",
    "0.75 คะแนน: ระดับที่ระบุตัวตนได้อย่างมีนัยสำคัญ (Significant): รูปภาพนั้นคลุมเครือไม่ชัด แต่ไม่มีข้อมูลอื่นที่เชื่อมโยงไปยังตัวตนของบุคคลได้",
    "1 คะแนน: ระดับที่ระบุตัวตนได้อย่างแน่ชัด (Maximum): รูปภาพชัดเจน และสามารถเชื่อมโยงไปยังข้อมูลเพิ่มเติมได้ (เช่น ข้อมูลการเป็นสมาชิกของชมรม หรือ ที่อยู่อาศัย)",
  ],
  alias: [
    "0.25 คะแนน: ระดับที่ไม่สามารถระบุตัวตนได้แน่ชัด (Negligible) : เมื่อรหัส/นามแฝงนั้นไม่สามารถเปิดเผยและเชื่อมโยงไปยังข้อมูลส่วนบุคคลของบุคคล เว้นแต่มีสิทธิเข้าถึงสถานที่เก็บข้อมูลนั้น",
    "0.75 คะแนน: ระดับที่ระบุตัวตนได้อย่างมีนัยสำคัญ (Significant): เมื่อนามแฝงเปิดเผยข้อมูลเกี่ยวกับบุคคล เช่น ชื่อจริง และเชื่อมโยงไปยังข้อมูลส่วนบุคคลอื่นได้ เช่น อีเมล์ของบุคคล",
    "1 คะแนน: ระดับที่ระบุตัวตนได้อย่างแน่ชัด (Maximum): เมื่อนามแฝงเปิดเผยชื่อเต็มของบุคคลหรือมีการเปิดเผยข้อมูลจากสถานที่เก็บข้อมูล",
  ],  
};

export type CBCategoryKey =
  | "confidentiality" | "integrity" | "availability" | "malicious";

export const CBCATEGORY_HINTS: Record<CBCategoryKey, string[]> = {
  confidentiality: [
    "0 คะแนน: การละเมิดความลับที่ไม่มีหลักฐานว่ามีการประมวลผลอย่างผิดกฎหมายเกิดขึ้น เช่น ไฟล์เอกสารหรือแลปทอปหายในช่วงส่งต่อ หรืออุปกรณ์ถูกละเมิดโดยไม่ได้ทำลายข้อมูลส่วนบุคคล",
    "0.25 คะแนน: ข้อมูลที่เปิดเผยไปยังผู้รับจำนวนหนึ่ง เช่น Email ที่มีข้อมูลส่วนบุคคลถูกส่งไปยังผู้รับผิดราย หรือกรณีที่ลูกค้าสามารถเข้าถึงข้อมูลของลูกค้ารายอื่นได้ผ่านช่องทางออนไลน์",
    "0.5 คะแนน: ข้อมูลถูกเปิดเผยไปยังผู้รับจำนวนหนึ่งที่ไม่ทราบว่าเป็นผู้ใด เช่น ข้อมูลอัปโหลดบนอืนเทอร์เน็ต ข้อมูลอัปโหลดบน P2P site ลูกจ้างขาย CD ROM ที่มีข้อมูลลูกค้า การวางระบบเวปไซท์ผิดพลาดจนทำให้ข้อมูลถูกทำให้เข้าถึงได้จากสาธารณะโดยผู้ใช้อินเทอร์เน็ต",
  ],
  integrity: [
    "0 คะแนน: ข้อมูลมีการเปลี่ยนแปลง แต่ไม่สามารถระบุได้ว่าข้อมูลใดที่ไม่ถูกต้องหรือข้อมูลถูกใช้งานอย่างผิดกฎหมาย เช่น ข้อมูลที่จัดเก็บได้ถูกอัพเดทอย่างไม่ถูกต้อง แต่ได้รับข้อมูลขุดแรกแล้วก่อนมีการเปลี่ยนแปลงในข้อมูล",
    "0.25 คะแนน: ข้อมูลมีการเปลี่ยนแปลง และสามารถระบุได้ว่าข้อมูลใดที่ไม่ถูกต้องหรือมีการใช่ข้อมูลถูอย่างผิดกฎหมาย แต่มีความเป็นไปได้ที่จะสำรองข้อมูลกลับมา เช่นข้อมูลที่มีความจำเป็นต่อการใช้บริการออนไลน์ได้ถูกเปลี่ยน และบุคคลต้องรับบริการผ่านทางออฟไลน์ หรือ ข้อมูลที่มีความสำคัญที่ต้องมีความถูกต้อง (Accuracy) ในระบบของหน่วยงานสุขภาพถูกแก้ไขเปลี่ยนแปลง",
    "0.5 คะแนน: ข้อมูลที่ถูกแก้ไขเปลี่ยนแปลงและอาจถูกใช้อย่างผิดกฎหมายโดยไม่มีความเป็นไปได้ที่จะกู้ข้อมูลนั้นคืนแล้ว เช่น ข้อมูลที่มีความจำเป็นต่อการใช้บริการออนไลน์ได้ถูกเปลี่ยนและบุคคลต้องรับบริการผ่านทางออฟไลน์ หรือ ข้อมูลที่มีความสำคัญที่ต้องมีความถูกต้อง (Accuracy) ในระบบของหน่วยงานสุขภาพถูกแก้ไขเปลี่ยนแปลง โดยไม่สามารถกู้คืนข้อมูลได้อีก",
  ],
  availability: [
    "0 คะแนน: ข้อมูลที่สามารถกู้คืนได้อย่างไม่ยากลำบาก เช่นข้อมูลไฟล์หาย แต่ยังมีข้อมูลสำรองเก็บไว้ หรือกรณีถังข้อมูลไม่สามารถใช้งานได้แต่สามาระกู้ได้จากถังข้อมูลชุดอื่น",
    "0.25 คะแนน: ข้อมูลหายชั่วคราว เช่น ถังข้อมูลไม่สามารถใช้งานได้แต่สามาระกู้ได้จากถังข้อมูลชุดอื่น โดยต้องประมวลผลบางประการเพื่อกู้คืน หรือข้อมูลหายแต่ยังสามารถขอจากบุคคลใหม่ได้อีกครั้ง",
    "0.5 คะแนน: ข้อมูลที่ไม่สามารถเรียกได้ โดยไม่สามารถกู้คืนได้ไม่ว่าจะจากผู้ควบคุมข้อมูลส่วนบุคคลเองหรือจากบุคคล เช่นข้อมูลหายและไม่สามารถขอจากบุคคลใหม่ได้แล้ว",
  ],
  malicious: [
    "0.5 คะแนน: การละเมิดเกิดจากความตั้งใจ เช่น ต้องการทำให้ผู้ควบคุมข้อมูลส่วนบุคคลเสียหาย (เช่น ทำให้ระบบความปลอดภัยเสียหาย) และ/หรือ เพื่อทำอันตรายแก่บุคคล เช่น ลูกจ้างตั้งใจเปิดเผยข้อมูลส่วนบุคคลจากช่องทาง โซเชียลมีเดีย หรือลูกจ้างขายข้อมูลส่วนตัวของลูกค้าให้บริษัทอื่น ผหรือผู้ใช้งานตั้งใจส่งข้อมูลของผู้ใช้งานรายอื่นไปยังสมาชิกครอบครัวของผู้ใช้รายอื่นนั้นเพื่อทำอันตราย",
  ],
};

export interface PropertyDef {
  key: string;       // unique key, e.g., "fullName"
  label: string;     // UI label
  category: DataCategory;
  eiKey: EICategoryKey | null; // tells EI which row this corresponds to
}

/** --------- EI / CB PROPERTY DEFINITIONS (global) --------- **/
export type EIPropertyDef = {
  key: EICategoryKey;
  label: string;
  preselected: boolean;
};

export type CBPropertyDef = {
  key: CBCategoryKey;
  label: string;
  preselected: boolean;
};

export const EI_PROPERTIES: EIPropertyDef[] = [
  { key: "fullName",     label: "ชื่อ - นามสกุล",                                  preselected: false }, // fallback will auto-preselect if none preselected
  { key: "email",        label: "E-mail",                                           preselected: false },
  { key: "idCard",       label: "ข้อมูลบัตรประชาชน พาสปอร์ตเลขประกันสังคม",       preselected: false },
  { key: "phoneAddress", label: "ข้อมูลเบอร์โทรศัพท์/ข้อมูลสถานที่อยู่อาศัย",      preselected: false },
  { key: "image",        label: "รูปภาพ",                                           preselected: false },
  { key: "alias",        label: "รหัส/นามแฝง/อักษรย่อ",                            preselected: false },
];

export const CB_PROPERTIES: CBPropertyDef[] = [
  { key: "confidentiality", label: "การละเมิดความลับของข้อมูลส่วนบุคคล",              preselected: false },
  { key: "integrity",       label: "การละเมิดความถูกต้องครบถ้วนของข้อมูลส่วนบุคคล",   preselected: false },
  { key: "availability",    label: "การละเมิดความพร้อมใช้งานของข้อมูลส่วนบุคคล",      preselected: false },
  { key: "malicious",       label: "ความตั้งใจที่ชั่วร้าย",                           preselected: false },
];

// Category → allowed scores
export const CATEGORY_SCORES: Record<DataCategory, number[]> = {
  simple: [1, 2, 3, 4],
  behavioral: [2, 1, 3, 4],
  financial: [3, 1, 2, 4],
  sensitive: [4, 1, 2, 3],
};

export const EI_CATEGORY_SCORES: Record<EICategoryKey, number[]> = {
  fullName: [0.25, 0.5, 0.75, 1],
  idCard: [0.25, 0.75, 1],
  phoneAddress: [0.25, 0.5, 1],
  email: [0.25, 0.75, 1],
  image: [0.25, 0.5, 0.75, 1],
  alias: [0.25, 0.75, 1],
};

export const CB_CATEGORY_SCORES: Record<CBCategoryKey, number[]> = {
  confidentiality: [0.25, 0.5],
  integrity: [0.25, 0.5],
  availability: [0.25, 0.5],
  malicious: [0.5],
};
